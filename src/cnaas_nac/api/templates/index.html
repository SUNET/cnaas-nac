<html>
  <head>
    <title>CNaaS</title>
    <script>
      function sortTable(n) {
	  var table, rows, switching, i, x, y, shouldSwitch, dir, switchcount = 0;
	  table = document.getElementById("users");
	  switching = true;
	  dir = "asc";
	  while (switching) {
	      switching = false;
	      rows = table.rows;
	      for (i = 1; i < (rows.length - 1); i++) {
		  shouldSwitch = false;
		  x = rows[i].getElementsByTagName("TD")[n];
		  y = rows[i + 1].getElementsByTagName("TD")[n];
		  if (dir == "asc") {
		      if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
			  shouldSwitch= true;
			  break;
		      }
		  } else if (dir == "desc") {
		      if (x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase()) {
			  shouldSwitch = true;
			  break;
		      }
		  }
	      }
	      if (shouldSwitch) {
		  rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
		  switching = true;
		  switchcount ++;
	      } else {
		  if (switchcount == 0 && dir == "asc") {
		      dir = "desc";
		      switching = true;
		  }
	      }
	  }
      }
    </script>
  </head>
  <style>
    #default-table {
	font-family: "Trebuchet MS", Arial, Helvetica, sans-serif;
	border-collapse: collapse;
	width: 100%;
    }

    #default-table td, #default-table th {
	border: 1px solid #ddd;
	padding: 8px;
    }

    #default-table tr:nth-child(even){
	background-color: #f2f2f2;
    }

    #default-table tr:hover {
	background-color: #ddd;
    }

    #default-table th {
	padding-top: 12px;
	padding-bottom: 12px;
	text-align: left;
	background-color: #E67527;
	color: white;
    }
  </style>

  <body style="background-color:#d0d0d0;text-align:left">
    <table id="default-table">
      <tr>
       <th>OUI</th>
       <th>VLAN</th>
       <th>Description</th>
      </tr>

      {% for oui in ouis %}
      <tr>
       <td>
	 {{ oui.oui }}
       </td>
       <td>
	 {{ oui.vlan }}
       </td>
       <td>
	 {{ oui.description }}
       </td>
      </tr>
      {% endfor %}
    </table>
    <br/><br/>
    <form action="" method="post" novalidate>
      {{ form.hidden_tag() }}
      <table id="default-table">
	<tr>
	  <th onclick="sortTable(0)">Select &#8595;</th>
	  <th onclick="sortTable(1)">Username &#8595;</th>
	  <th onclick="sortTable(2)">Attribute &#8595;</th>
	  <th onclick="sortTable(3)">Type &#8595;</th>
	  <th onclick="sortTable(4)">Value &#8595;</th>
	  <th onclick="sortTable(5)">Calling Station ID &#8595;</th>
	  <th onclick="sortTable(6)">Called Station ID &#8595;</th>
	  <th onclick="sortTable(7)">Port &#8595;</th>
	  <th onclick="sortTable(8)">Status &#8595;</th>
	  <th onclick="sortTable(9)">Last seen (UTC) &#8595;</th>
	</tr>

	{% for user in users %}
	<tr>
	  <td>{{ form.selected(value=user.username) }}</td>
	  <td>{{ user.username }}</td>
	  {% for attr in user.reply %}
	  <td>
	    {{ attr.value }}
	  </td>
	  {% endfor %}
	  <td>
	    {{ user.calling_station_id }}
	  </td>
	  <td>
	    {{ user.called_station_id }}
	  </td>
	  <td>
	    {{ user.nas_port_id }}
	  </td>
	  {% if user.active %}
	  <td bgcolor="lightgreen">
	    Enabled
	  </td>
	  {% else %}
	  <td>
	    Disabled
	  </td>
	  {% endif %}
	  <td>
	    {{ user.last_seen }}
	  </td>
	</tr>
	{% endfor %}
      </table>
      <span class="right">{{ form.set_vlan_btn }} {{ form.set_vlan }}</span>
      <span class="left">{{ form.delete() }} {{ form.enable }} {{ form.disable }}</span>
      <hr>
      <p>
	Username: {{ form.username(size=32) }}
	Password: {{ form.password(size=32) }}
	VLAN: {{ form.vlan(size=32) }}
	{{ form.submit() }}
      </p>
    </form>
  </body>
</html>
